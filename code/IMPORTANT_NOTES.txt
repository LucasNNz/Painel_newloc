================================================================================
                    PORTAL NEWLOC - NOTAS IMPORTANTES
================================================================================

üìù AJUSTE NECESS√ÅRIO NO next.config.js
----------------------------------------

Para que o Dockerfile funcione corretamente, √© necess√°rio ajustar o arquivo:
nextjs_space/next.config.js

Linha que precisa ser alterada:
  output: process.env.NEXT_OUTPUT_MODE,

Para:
  output: process.env.NEXT_OUTPUT_MODE || 'standalone',

Ou simplesmente:
  output: 'standalone',

Isso garante que o Next.js gere o build standalone necess√°rio para o Docker.

================================================================================

üîê SECRETS IMPORTANTES
----------------------

Antes do primeiro deploy, gere secrets seguros:

# NEXTAUTH_SECRET
openssl rand -base64 32

# JWT_SECRET  
openssl rand -base64 32

# DB_PASSWORD
openssl rand -base64 24

E adicione no arquivo .env

================================================================================

üìÅ ARQUIVOS CRIADOS
-------------------

‚úÖ Dockerfile                 - Build multi-stage otimizado
‚úÖ docker-compose.yml         - Orquestra√ß√£o completa
‚úÖ .dockerignore             - Otimiza√ß√£o do build
‚úÖ .env.example              - Template de vari√°veis
‚úÖ nginx.conf                - Proxy reverso e SSL
‚úÖ deploy.sh                 - Script de deploy automatizado
‚úÖ backup.sh                 - Script de backup do banco
‚úÖ README.md                 - Documenta√ß√£o principal
‚úÖ API_DOCUMENTATION.md      - Refer√™ncia completa da API
‚úÖ N8N_INTEGRATION.md        - Guia de integra√ß√£o n8n
‚úÖ DEPLOY_GUIDE.md           - Guia completo de deploy

================================================================================

üöÄ PR√ìXIMOS PASSOS
------------------

1. Ajustar next.config.js conforme descrito acima

2. Configurar vari√°veis de ambiente:
   cp .env.example .env
   nano .env
   (Preencher todos os valores)

3. Executar o deploy:
   chmod +x deploy.sh backup.sh
   ./deploy.sh

4. Configurar dom√≠nio:
   - Apontar DNS para o servidor
   - Instalar NGINX
   - Obter certificado SSL com certbot

5. Testar a aplica√ß√£o:
   curl http://localhost:3000/api/health

6. Configurar backup autom√°tico:
   crontab -e
   Adicionar: 0 3 * * * cd /opt/portal_newloc && ./backup.sh

================================================================================

‚ö†Ô∏è  IMPORTANTE PARA PRODU√á√ÉO
----------------------------

1. Alterar TODAS as senhas padr√£o
2. Gerar novos secrets (nunca use os de exemplo)
3. Configurar firewall (permitir apenas 80/443)
4. N√£o expor Adminer publicamente
5. Configurar SSL/HTTPS obrigat√≥rio
6. Ativar backups autom√°ticos
7. Monitorar logs regularmente
8. Manter Docker e sistema atualizados

================================================================================

üìä ESTRUTURA DE PASTAS AP√ìS BUILD
----------------------------------

/opt/portal_newloc/
‚îú‚îÄ‚îÄ nextjs_space/              # C√≥digo-fonte
‚îÇ   ‚îú‚îÄ‚îÄ .next/                # Build do Next.js
‚îÇ   ‚îú‚îÄ‚îÄ node_modules/         # Depend√™ncias
‚îÇ   ‚îî‚îÄ‚îÄ prisma/               # Schema e migrations
‚îú‚îÄ‚îÄ backups/                   # Backups do banco (criado automaticamente)
‚îú‚îÄ‚îÄ .env                       # Vari√°veis de ambiente (criar do .env.example)
‚îî‚îÄ‚îÄ [arquivos de config]

/var/lib/docker/volumes/
‚îî‚îÄ‚îÄ newloc_pgdata/            # Dados do PostgreSQL

================================================================================

üîó URLs IMPORTANTES
-------------------

Aplica√ß√£o: http://localhost:3000 (desenvolvimento)
Aplica√ß√£o: https://app.newloc.com (produ√ß√£o)
Adminer: http://localhost:8080 (opcional)
Health: http://localhost:3000/api/health

Login Admin:
  Email: admin@newloc.com
  Senha: Admin@123 (ALTERAR!)

================================================================================

üìû COMANDOS √öTEIS
-----------------

# Ver logs
docker compose logs -f

# Status dos servi√ßos
docker compose ps

# Reiniciar
docker compose restart

# Backup manual
./backup.sh

# Entrar no container
docker compose exec web sh

# Executar migrations
docker compose exec web npx prisma migrate deploy

# Popular dados
docker compose exec web npx prisma db seed

================================================================================

üêõ TROUBLESHOOTING R√ÅPIDO
-------------------------

Problema: Aplica√ß√£o n√£o inicia
Solu√ß√£o: docker compose logs web

Problema: Erro de conex√£o com banco
Solu√ß√£o: docker compose restart db

Problema: NGINX 502 Bad Gateway
Solu√ß√£o: curl http://localhost:3000/api/health && sudo systemctl restart nginx

Problema: SSL n√£o funciona
Solu√ß√£o: sudo certbot renew --force-renewal

Problema: Alto uso de mem√≥ria
Solu√ß√£o: docker system prune -a

================================================================================

Para mais detalhes, consulte:
- DEPLOY_GUIDE.md
- API_DOCUMENTATION.md
- N8N_INTEGRATION.md

================================================================================
